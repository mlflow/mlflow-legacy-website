
  

<!DOCTYPE html>
<!-- source: docs/source/python_api/mlflow.tracing.rst -->
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mlflow.tracing &mdash; MLflow 2.12.2 documentation</title>
  
   
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
  <link rel="canonical" href="https://mlflow.org/docs/latest/python_api/mlflow.tracing.html">
  
  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    

    

  
    
        <!-- Google Tag Manager -->
        <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
        j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
        'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
        })(window,document,'script','dataLayer',"GTM-N6WMTTJ");</script>
        <!-- End Google Tag Manager -->
    

  

  
  
    

  

  
  
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/cards.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/grids.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/mobile.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/simple-cards.css" type="text/css" />
    <link rel="stylesheet" href="../_static/css/tabs.css" type="text/css" />
    
  
        <link rel="index" title="Index"
              href="../genindex.html"/>
        <link rel="search" title="Search" href="../search.html"/>
    <link rel="top" title="MLflow 2.12.2 documentation" href="../index.html"/>
        <link rel="up" title="Python API" href="index.html"/>
        <link rel="next" title="mlflow.transformers" href="/mlflow.transformers.html"/>
        <link rel="prev" title="mlflow.tensorflow" href="/mlflow.tensorflow.html"/> 

  
  <script src="../_static/js/modernizr.min.js"></script>

</head>
<script type="text/javascript" src="../_static/jquery.js"></script>
<script type="text/javascript" src="../_static/underscore.js"></script>
<script type="text/javascript" src="../_static/doctools.js"></script>
<script type="text/javascript" src="../_static/languagesections.js"></script>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/@jupyter-widgets/html-manager@^1.0.1/dist/embed-amd.js"></script>

<body class="wy-body-for-nav" role="document">
  
    <!-- Google Tag Manager (noscript) -->
    <noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-N6WMTTJ"
    height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
    <!-- End Google Tag Manager (noscript) -->
  

  
  <nav class="wy-nav-top header" role="navigation" aria-label="top navigation">
    <ul>
  <li class="menu-toggle">
    <i data-toggle="wy-nav-top" class="wy-nav-top-menu-button db-icon db-icon-menu pull-left"></i>
    <a href="../index.html" class="wy-nav-top-logo"
      ><img src="../_static/MLflow-logo-final-black.png" alt="MLflow"
    /></a>
    <span class="version">2.12.2</span>
  </li>
</ul>
  </nav>
  <page>
    

    <nav data-toggle="wy-nav-shift" class="wy-nav-side relative">
      <div class="wy-side-scroll">
  <div class="wy-side-nav-search">
    

    

    
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
  </form>
</div>


    
  </div>

  <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
    
      <a href="../index.html" class="main-navigation-home"><img src="../_static/icons/nav-home.svg"> MLflow</a>
    

    
      

      
        <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../introduction/index.html">What is MLflow?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../getting-started/index.html">Getting Started with MLflow</a></li>
<li class="toctree-l1"><a class="reference internal" href="../new-features/index.html">New Features</a></li>
<li class="toctree-l1"><a class="reference internal" href="../llms/index.html">LLMs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model-evaluation/index.html">Model Evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deep-learning/index.html">Deep Learning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../traditional-ml/index.html">Traditional ML</a></li>
<li class="toctree-l1"><a class="reference internal" href="../deployment/index.html">Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tracking.html">MLflow Tracking</a></li>
<li class="toctree-l1"><a class="reference internal" href="../system-metrics/index.html">System Metrics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../projects.html">MLflow Projects</a></li>
<li class="toctree-l1"><a class="reference internal" href="../models.html">MLflow Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model-registry.html">MLflow Model Registry</a></li>
<li class="toctree-l1"><a class="reference internal" href="../recipes.html">MLflow Recipes</a></li>
<li class="toctree-l1"><a class="reference internal" href="../plugins.html">MLflow Plugins</a></li>
<li class="toctree-l1"><a class="reference internal" href="../auth/index.html">MLflow Authentication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cli.html">Command-Line Interface</a></li>
<li class="toctree-l1"><a class="reference internal" href="../search-runs.html">Search Runs</a></li>
<li class="toctree-l1"><a class="reference internal" href="../search-experiments.html">Search Experiments</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Python API</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="mlflow.html">mlflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.artifacts.html">mlflow.artifacts</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.catboost.html">mlflow.catboost</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.client.html">mlflow.client</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.config.html">mlflow.config</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.data.html">mlflow.data</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.deployments.html">mlflow.deployments</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.diviner.html">mlflow.diviner</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.entities.html">mlflow.entities</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.environment_variables.html">mlflow.environment_variables</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.fastai.html">mlflow.fastai</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.gateway.html">mlflow.gateway</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.gluon.html">mlflow.gluon</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.h2o.html">mlflow.h2o</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.johnsnowlabs.html">mlflow.johnsnowlabs</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.keras.html">mlflow.keras</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.langchain.html">mlflow.langchain</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.lightgbm.html">mlflow.lightgbm</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.metrics.html">mlflow.metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.mleap.html">mlflow.mleap</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.models.html">mlflow.models</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.onnx.html">mlflow.onnx</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.paddle.html">mlflow.paddle</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.pmdarima.html">mlflow.pmdarima</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.projects.html">mlflow.projects</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.promptflow.html">mlflow.promptflow</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.prophet.html">mlflow.prophet</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.pyfunc.html">mlflow.pyfunc</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.pyspark.ml.html">mlflow.pyspark.ml</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.pytorch.html">mlflow.pytorch</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.recipes.html">mlflow.recipes</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.sagemaker.html">mlflow.sagemaker</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.sentence_transformers.html">mlflow.sentence_transformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.server.html">mlflow.server</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.shap.html">mlflow.shap</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.sklearn.html">mlflow.sklearn</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.spacy.html">mlflow.spacy</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.spark.html">mlflow.spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.statsmodels.html">mlflow.statsmodels</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.system_metrics.html">mlflow.system_metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.tensorflow.html">mlflow.tensorflow</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">mlflow.tracing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#automatic-instrumentation">Automatic instrumentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#fluent-apis">Fluent APIs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mlflow-client-apis">MLflow Client APIs</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.transformers.html">mlflow.transformers</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.types.html">mlflow.types</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.utils.html">mlflow.utils</a></li>
<li class="toctree-l2"><a class="reference internal" href="mlflow.xgboost.html">mlflow.xgboost</a></li>
<li class="toctree-l2"><a class="reference internal" href="openai/index.html">mlflow.openai</a></li>
<li class="toctree-l2"><a class="reference internal" href="index.html#log-levels">Log Levels</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../R-api.html">R API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../java_api/index.html">Java API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rest-api.html">REST API</a></li>
<li class="toctree-l1"><a class="reference internal" href="../docker.html">Official MLflow Docker Image</a></li>
<li class="toctree-l1"><a class="reference internal" href="../community-model-flavors.html">Community Model Flavors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../tutorials-and-examples/index.html">Tutorials and Examples</a></li>
</ul>

      
    
  </div>

  <div role="contentinfo">
    

    <p>
      <a id='feedbacklink' href="https://github.com/mlflow/mlflow/blob/master/CONTRIBUTING.md" target="_blank">Contribute</a>
    </p>
  </div>
</div>
    </nav>

    <main class="wy-grid-for-nav">
      <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
        <div class="wy-nav-content">
          <div class="rst-content">
            










<div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="../index.html">Documentation</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
        <li><a href="index.html">Python API</a> <span class="db-icon db-icon-chevron-right"></span></li>
    
    
      <li>mlflow.tracing</li>
    
    
    <!-- <li class="wy-breadcrumbs-aside">
      <a href="https://github.com/mlflow/mlflow/blob/master/docs/source/python_api/mlflow.tracing.rst" class="fa fa-github"> Edit on GitHub</a>
    </li> -->
    
  </ul>
</div>
            <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
              <div itemprop="articleBody">
                
  <div class="section" id="mlflow-tracing">
<h1>mlflow.tracing<a class="headerlink" href="#mlflow-tracing" title="Permalink to this headline"> </a></h1>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>This is a tentative documentation for the development period. The main objective is to serve as an up-to-date internal reference for API specifications and notable implementation details. The documentation must be updated and polished before the official release.</p>
</div>
<p>MLflow Tracing Python APIs instrument machine learning application, so that developers can easily debug and monitor their systems.</p>
<div class="contents local topic" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#automatic-instrumentation" id="id1">Automatic instrumentation</a></p></li>
<li><p><a class="reference internal" href="#fluent-apis" id="id2">Fluent APIs</a></p></li>
<li><p><a class="reference internal" href="#mlflow-client-apis" id="id3">MLflow Client APIs</a></p></li>
</ul>
</div>
<div class="section" id="automatic-instrumentation">
<span id="tracing-automatic-instrumentation"></span><h2><a class="toc-backref" href="#id1">Automatic instrumentation</a><a class="headerlink" href="#automatic-instrumentation" title="Permalink to this headline"> </a></h2>
<p><em>This will cover LangChain/OpenAI/etc auto-instrumentation once implemented.</em></p>
</div>
<div class="section" id="fluent-apis">
<span id="tracing-fluent-apis"></span><h2><a class="toc-backref" href="#id2">Fluent APIs</a><a class="headerlink" href="#fluent-apis" title="Permalink to this headline"> </a></h2>
<p>Fluent APIs are high-level APIs that allow developers to instrument their code with minimal changes. The APIs are designed to be easy to use that manages the spans parent-child relationships and set some fields of the span automatically. When instrumenting Python code, it is generally recommended to use Fluent APIs over MLflow Client APIs as they are more user-friendly and less error-prone.</p>
<dl class="py function">
<dt>
<code class="sig-prename descclassname"><span class="pre">mlflow.</span></code><code class="sig-name descname"><span class="pre">trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'UNKNOWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="reference internal" href="../_modules/mlflow/tracing/fluent.html#trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>A decorator that creates a new span for the decorated function.</p>
<p>When you decorate a function with this <a class="reference internal" href="mlflow.html#mlflow.trace" title="mlflow.trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;mlflow.trace()</span></code></a> decorator,
a span will be created for the scope of the decorated function. The span will automatically
capture the input and output of the function. When it is applied to a method, it doesn’t
capture the <cite>self</cite> argument. Any exception raised within the function will set the span
status to <code class="docutils literal notranslate"><span class="pre">ERROR</span></code> and detailed information such as exception message and stacktrace
will be recorded to the <code class="docutils literal notranslate"><span class="pre">attributes</span></code> field of the span.</p>
<p>For example, the following code will yield a span with the name <code class="docutils literal notranslate"><span class="pre">&quot;my_function&quot;</span></code>,
capturing the input arguments <code class="docutils literal notranslate"><span class="pre">x</span></code> and <code class="docutils literal notranslate"><span class="pre">y</span></code>, and the output of the function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nd">@mlflow</span><span class="o">.</span><span class="n">trace</span>
<span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
</pre></div>
</div>
<p>This is equivalent to doing the following using the <a class="reference internal" href="mlflow.html#mlflow.start_span" title="mlflow.start_span"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlflow.start_span()</span></code></a> context
manager, but requires less boilerplate code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>


<span class="k">with</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">start_span</span><span class="p">(</span><span class="s2">&quot;my_function&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">span</span><span class="p">:</span>
    <span class="n">span</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="n">x</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">})</span>
    <span class="n">result</span> <span class="o">=</span> <span class="n">my_function</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
    <span class="n">span</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">({</span><span class="s2">&quot;output&quot;</span><span class="p">:</span> <span class="n">result</span><span class="p">})</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The &#64;mlflow.trace decorator is useful when you want to trace a function defined by
yourself. However, you may also want to trace a function in external libraries. In
such case, you can use this <code class="docutils literal notranslate"><span class="pre">mlflow.trace()</span></code> function to directly wrap the function,
instead of using as the decorator. This will create the exact same span as the
one created by the decorator i.e. captures information from the function call.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">some.external.library</span> <span class="kn">import</span> <span class="n">predict</span>

<span class="n">mlflow</span><span class="o">.</span><span class="n">trace</span><span class="p">(</span><span class="n">predict</span><span class="p">)(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>func</strong> – The function to be decorated. Must <strong>not</strong> be provided when using as a decorator.</p></li>
<li><p><strong>name</strong> – The name of the span. If not provided, the name of the function will be used.</p></li>
<li><p><strong>span_type</strong> – The type of the span. Can be either a string or a
<a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanType" title="mlflow.entities.SpanType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanType</span></code></a> enum value.</p></li>
<li><p><strong>attributes</strong> – A dictionary of attributes to set on the span.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt>
<code class="sig-prename descclassname"><span class="pre">mlflow.</span></code><code class="sig-name descname"><span class="pre">start_span</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'span'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'UNKNOWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mlflow/tracing/fluent.html#start_span"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Context manager to create a new span and start it as the current span in the context.</p>
<p>This context manager automatically manages the span lifecycle and parent-child relationships.
The span will be ended when the context manager exits. Any exception raised within the
context manager will set the span status to <code class="docutils literal notranslate"><span class="pre">ERROR</span></code>, and detailed information such as
exception message and stacktrace will be recorded to the <code class="docutils literal notranslate"><span class="pre">attributes</span></code> field of the span.
New spans can be created within the context manager, then they will be assigned as child
spans.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">start_span</span><span class="p">(</span><span class="s2">&quot;my_span&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">span</span><span class="p">:</span>
    <span class="n">span</span><span class="o">.</span><span class="n">set_inputs</span><span class="p">({</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">})</span>

    <span class="n">z</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

    <span class="n">span</span><span class="o">.</span><span class="n">set_outputs</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
    <span class="n">span</span><span class="o">.</span><span class="n">set_attribute</span><span class="p">(</span><span class="s2">&quot;key&quot;</span><span class="p">,</span> <span class="s2">&quot;value&quot;</span><span class="p">)</span>
    <span class="c1"># do something</span>
</pre></div>
</div>
<p>When this context manager is used in the top-level scope, i.e. not within another span context,
the span will be treated as a root span. The root span doesn’t have a parent reference and
<strong>the entire trace will be logged when the root span is ended</strong>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>If you want more explicit control over the trace lifecycle, you can use
<a class="reference internal" href="mlflow.client.html#mlflow.client.MlflowClient.start_trace" title="mlflow.client.MlflowClient.start_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">MLflow</span> <span class="pre">Client</span> <span class="pre">APIs</span></code></a>. It provides lower
level to start and end traces manually, as well as setting the parent spans explicitly.
However, it is generally recommended to use this context manager as long as it satisfies
your requirements, because it requires less boilerplate code and is less error-prone.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The context manager doesn’t propagate the span context across threads. If you want to create
a child span in a different thread, you should use
<a class="reference internal" href="mlflow.client.html#mlflow.client.MlflowClient.start_trace" title="mlflow.client.MlflowClient.start_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">MLflow</span> <span class="pre">Client</span> <span class="pre">APIs</span></code></a>
and pass the parent span ID explicitly.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All spans created under the root span (i.e. a single trace) are buffered in memory and
not exported until the root span is ended. The buffer has a default size of 1000 traces
and TTL of 1 hour. You can configure the buffer size and TTL using the environment variables
<code class="docutils literal notranslate"><span class="pre">MLFLOW_TRACE_BUFFER_MAX_SIZE</span></code> and <code class="docutils literal notranslate"><span class="pre">MLFLOW_TRACE_BUFFER_TTL_SECONDS</span></code> respectively.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the span.</p></li>
<li><p><strong>span_type</strong> – The type of the span. Can be either a string or
a <a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanType" title="mlflow.entities.SpanType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanType</span></code></a> enum value</p></li>
<li><p><strong>attributes</strong> – A dictionary of attributes to set on the span.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Yields an <a class="reference internal" href="mlflow.entities.html#mlflow.entities.Span" title="mlflow.entities.Span"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlflow.entities.Span</span></code></a> that represents the created span.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt>
<code class="sig-prename descclassname"><span class="pre">mlflow.</span></code><code class="sig-name descname"><span class="pre">get_trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">request_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="mlflow.entities.html#mlflow.entities.Trace" title="mlflow.entities.Trace"><span class="pre">Trace</span></a><a class="reference internal" href="../_modules/mlflow/tracing/fluent.html#get_trace"><span class="viewcode-link"><span class="pre">[source]</span></span></a></dt>
<dd><p>Get a trace by the given request ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A <a class="reference internal" href="mlflow.entities.html#mlflow.entities.Trace" title="mlflow.entities.Trace"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlflow.entities.Trace</span></code></a> objects with the given request ID.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="mlflow-client-apis">
<span id="tracing-client-apis"></span><h2><a class="toc-backref" href="#id3">MLflow Client APIs</a><a class="headerlink" href="#mlflow-client-apis" title="Permalink to this headline"> </a></h2>
<p><a class="reference internal" href="mlflow.client.html#mlflow.client.MlflowClient" title="mlflow.client.MlflowClient"><code class="xref py py-class docutils literal notranslate"><span class="pre">MlflowClient</span></code></a> exposes APIs to start and end traces, spans, and set fields of the spans, with more flexibility and control to the trace lifecycle and structure. They are useful when the Fluent APIs are not sufficient for the use case, such as multi-threaded applications, callbacks, etc.</p>
<dl class="py function">
<dt>
<code class="sig-prename descclassname"><span class="pre">mlflow.client.MlflowClient.</span></code><code class="sig-name descname"><span class="pre">start_trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'UNKNOWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tags</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">experiment_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="mlflow.entities.html#mlflow.entities.Span" title="mlflow.entities.Span"><span class="pre">Span</span></a></dt>
<dd><p>Create a new trace object and start a root span under it.</p>
<p>This is an imperative API to manually create a new span under a specific trace id and
parent span, unlike the higher-level APIs like <a class="reference internal" href="mlflow.html#mlflow.trace" title="mlflow.trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;mlflow.trace</span></code></a>
and <a class="reference internal" href="mlflow.html#mlflow.start_span" title="mlflow.start_span"><code class="xref py py-func docutils literal notranslate"><span class="pre">with</span> <span class="pre">mlflow.start_span()</span></code></a>, which automatically manage
the span lifecycle and parent-child relationship. You only need to call this method
when using the <a class="reference internal" href="mlflow.client.html#mlflow.client.MlflowClient.start_span" title="mlflow.client.MlflowClient.start_span"><code class="xref py py-func docutils literal notranslate"><span class="pre">start_span()</span></code></a> method of MlflowClient to create
spans.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>A trace started with this method must be ended by calling
<code class="docutils literal notranslate"><span class="pre">MlflowClient().end_trace(request_id)</span></code>. Otherwise the trace will be not recorded.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the trace (and the root span).</p></li>
<li><p><strong>span_type</strong> – The type of the span.</p></li>
<li><p><strong>inputs</strong> – Inputs to set on the root span of the trace.</p></li>
<li><p><strong>attributes</strong> – A dictionary of attributes to set on the root span of the trace.</p></li>
<li><p><strong>tags</strong> – A dictionary of tags to set on the trace.</p></li>
<li><p><strong>experiment_id</strong> – The ID of the experiment to create the trace in. If not provided,
MLflow will look for valid experiment in the following order: activated using
<a class="reference internal" href="mlflow.html#mlflow.set_experiment" title="mlflow.set_experiment"><code class="xref py py-func docutils literal notranslate"><span class="pre">mlflow.set_experiment()</span></code></a>,
<code class="docutils literal notranslate"><span class="pre">MLFLOW_EXPERIMENT_NAME</span></code> environment variable, <code class="docutils literal notranslate"><span class="pre">MLFLOW_EXPERIMENT_ID</span></code>
environment variable, or the default experiment as defined by the tracking server.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <a class="reference internal" href="mlflow.entities.html#mlflow.entities.Span" title="mlflow.entities.Span"><code class="xref py py-class docutils literal notranslate"><span class="pre">Span</span></code></a> object
representing the root span of the trace.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mlflow</span> <span class="kn">import</span> <span class="n">MlflowClient</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>

<span class="n">root_span</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">start_trace</span><span class="p">(</span><span class="s2">&quot;my_trace&quot;</span><span class="p">)</span>
<span class="n">request_id</span> <span class="o">=</span> <span class="n">root_span</span><span class="o">.</span><span class="n">request_id</span>

<span class="c1"># Create a child span</span>
<span class="n">child_span</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">start_span</span><span class="p">(</span>
    <span class="s2">&quot;child_span&quot;</span><span class="p">,</span> <span class="n">request_id</span><span class="o">=</span><span class="n">request_id</span><span class="p">,</span> <span class="n">parent_id</span><span class="o">=</span><span class="n">root_span</span><span class="o">.</span><span class="n">span_id</span>
<span class="p">)</span>
<span class="c1"># Do something...</span>
<span class="n">client</span><span class="o">.</span><span class="n">end_span</span><span class="p">(</span><span class="n">request_id</span><span class="o">=</span><span class="n">request_id</span><span class="p">,</span> <span class="n">span_id</span><span class="o">=</span><span class="n">child_span</span><span class="o">.</span><span class="n">span_id</span><span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">end_trace</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt>
<code class="sig-prename descclassname"><span class="pre">mlflow.client.MlflowClient.</span></code><code class="sig-name descname"><span class="pre">end_trace</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanStatus" title="mlflow.entities.SpanStatus"><span class="pre">SpanStatus</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'OK'</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>End the trace with the given trace ID. This will end the root span of the trace and
log the trace to the backend if configured.</p>
<p>If any of children spans are not ended, they will be ended forcefully with the status
<code class="docutils literal notranslate"><span class="pre">TRACE_STATUS_UNSPECIFIED</span></code>. If the trace is already ended, this method will have
no effect.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request_id</strong> – The ID of the trace to end.</p></li>
<li><p><strong>outputs</strong> – Outputs to set on the trace.</p></li>
<li><p><strong>attributes</strong> – A dictionary of attributes to set on the trace. If the trace already
has attributes, the new attributes will be merged with the existing ones.
If the same key already exists, the new value will overwrite the old one.</p></li>
<li><p><strong>status</strong> – The status of the trace. This can be a
<a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanStatus" title="mlflow.entities.SpanStatus"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanStatus</span></code></a> object or a string
representing the status code defined in
<a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanStatusCode" title="mlflow.entities.SpanStatusCode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanStatusCode</span></code></a>
e.g. <code class="docutils literal notranslate"><span class="pre">&quot;OK&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ERROR&quot;</span></code>. The default status is OK.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt>
<code class="sig-prename descclassname"><span class="pre">mlflow.client.MlflowClient.</span></code><code class="sig-name descname"><span class="pre">start_span</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">parent_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_type</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'UNKNOWN'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">inputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <a class="reference internal" href="mlflow.entities.html#mlflow.entities.Span" title="mlflow.entities.Span"><span class="pre">Span</span></a></dt>
<dd><p>Create a new span and start it without attaching it to the global trace context.</p>
<p>This is an imperative API to manually create a new span under a specific trace id
and parent span, unlike the higher-level APIs like
<a class="reference internal" href="mlflow.html#mlflow.trace" title="mlflow.trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;mlflow.trace</span></code></a> decorator and
<a class="reference internal" href="mlflow.html#mlflow.start_span" title="mlflow.start_span"><code class="xref py py-func docutils literal notranslate"><span class="pre">with</span> <span class="pre">mlflow.start_span()</span></code></a> context manager, which
automatically manage the span lifecycle and parent-child relationship.</p>
<p>This API is useful for the case where the automatic context management is not
sufficient, such as callback-based instrumentation where span start and end are
not in the same call stack, or multi-threaded applications where the context is
not propagated automatically.</p>
<p>This API requires a parent span ID to be provided explicitly. If you haven’t
started any span yet, use the <a class="reference internal" href="mlflow.client.html#mlflow.client.MlflowClient.start_trace" title="mlflow.client.MlflowClient.start_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">start_trace()</span></code></a> method to
start a new trace and a root span.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The span created with this method needs to be ended explicitly by calling
the <a class="reference internal" href="mlflow.client.html#mlflow.client.MlflowClient.end_span" title="mlflow.client.MlflowClient.end_span"><code class="xref py py-func docutils literal notranslate"><span class="pre">end_span()</span></code></a> method. Otherwise the span will be
recorded with the incorrect end time and status <code class="docutils literal notranslate"><span class="pre">TRACE_STATUS_UNSPECIFIED</span></code>.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Instead of creating a root span with the <a class="reference internal" href="mlflow.client.html#mlflow.client.MlflowClient.start_trace" title="mlflow.client.MlflowClient.start_trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">start_trace()</span></code></a>
method, you can also use this method within the context of a parent span created
by the fluent APIs like <a class="reference internal" href="mlflow.html#mlflow.trace" title="mlflow.trace"><code class="xref py py-func docutils literal notranslate"><span class="pre">&#64;mlflow.trace</span></code></a> and
<a class="reference internal" href="mlflow.html#mlflow.start_span" title="mlflow.start_span"><code class="xref py py-func docutils literal notranslate"><span class="pre">with</span> <span class="pre">mlflow.start_span()</span></code></a>, by passing its span
ids the parent. This flexibility allows you to use the imperative APIs in
conjunction with the fluent APIs like below:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mlflow</span>
<span class="kn">from</span> <span class="nn">mlflow</span> <span class="kn">import</span> <span class="n">MlflowClient</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>

<span class="k">with</span> <span class="n">mlflow</span><span class="o">.</span><span class="n">start_span</span><span class="p">(</span><span class="s2">&quot;parent_span&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">parent_span</span><span class="p">:</span>
    <span class="n">child_span</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">start_span</span><span class="p">(</span>
        <span class="n">name</span><span class="o">=</span><span class="s2">&quot;child_span&quot;</span><span class="p">,</span>
        <span class="n">request_id</span><span class="o">=</span><span class="n">parent_span</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span>
        <span class="n">parent_id</span><span class="o">=</span><span class="n">parent_span</span><span class="o">.</span><span class="n">span_id</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="c1"># Do something...</span>

    <span class="n">client</span><span class="o">.</span><span class="n">end_span</span><span class="p">(</span>
        <span class="n">request_id</span><span class="o">=</span><span class="n">parent_span</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span>
        <span class="n">span_id</span><span class="o">=</span><span class="n">child_span</span><span class="o">.</span><span class="n">span_id</span><span class="p">,</span>
    <span class="p">)</span>
</pre></div>
</div>
<p>However, <strong>the opposite does not work</strong>. You cannot use the fluent APIs within
the span created by this MlflowClient API. This is because the fluent APIs
fetches the current span from the managed context, which is not set by the MLflow
Client APIs. Once you create a span with the MLflow Client APIs, all children
spans must be created with the MLflow Client APIs. Please be cautious when using
this mixed approach, as it can lead to unexpected behavior if not used properly.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>name</strong> – The name of the span.</p></li>
<li><p><strong>request_id</strong> – The ID of the trace to attach the span to. This is synonym to
trace_id` in OpenTelemetry.</p></li>
<li><p><strong>span_type</strong> – The type of the span. Can be either a string or a
<a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanType" title="mlflow.entities.SpanType"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanType</span></code></a> enum value.</p></li>
<li><p><strong>parent_id</strong> – The ID of the parent span. The parent span can be a span created by
both fluent APIs like <cite>with mlflow.start_span()</cite>, and imperative APIs like this.</p></li>
<li><p><strong>inputs</strong> – Inputs to set on the span.</p></li>
<li><p><strong>attributes</strong> – A dictionary of attributes to set on the span.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>An <a class="reference internal" href="mlflow.entities.html#mlflow.entities.Span" title="mlflow.entities.Span"><code class="xref py py-class docutils literal notranslate"><span class="pre">mlflow.entities.Span</span></code></a> object representing the span.</p>
</dd>
</dl>
<p>Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mlflow</span> <span class="kn">import</span> <span class="n">MlflowClient</span>

<span class="n">client</span> <span class="o">=</span> <span class="n">MlflowClient</span><span class="p">()</span>

<span class="n">span</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">start_trace</span><span class="p">(</span><span class="s2">&quot;my_trace&quot;</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="mi">2</span>

<span class="c1"># Create a child span</span>
<span class="n">child_span</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">start_span</span><span class="p">(</span>
    <span class="s2">&quot;child_span&quot;</span><span class="p">,</span>
    <span class="n">request_id</span><span class="o">=</span><span class="n">span</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span>
    <span class="n">parent_id</span><span class="o">=</span><span class="n">span</span><span class="o">.</span><span class="n">id</span><span class="p">,</span>
    <span class="n">inputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;x&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">y</span> <span class="o">=</span> <span class="n">x</span><span class="o">**</span><span class="mi">2</span>

<span class="n">client</span><span class="o">.</span><span class="n">end_span</span><span class="p">(</span>
    <span class="n">request_id</span><span class="o">=</span><span class="n">child_span</span><span class="o">.</span><span class="n">request_id</span><span class="p">,</span>
    <span class="n">span_id</span><span class="o">=</span><span class="n">child_span</span><span class="o">.</span><span class="n">span_id</span><span class="p">,</span>
    <span class="n">attributes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;factor&quot;</span><span class="p">:</span> <span class="mi">2</span><span class="p">},</span>
    <span class="n">outputs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;y&quot;</span><span class="p">:</span> <span class="n">y</span><span class="p">},</span>
<span class="p">)</span>

<span class="n">client</span><span class="o">.</span><span class="n">end_trace</span><span class="p">(</span><span class="n">request_id</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt>
<code class="sig-prename descclassname"><span class="pre">mlflow.client.MlflowClient.</span></code><code class="sig-name descname"><span class="pre">end_span</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">self</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">request_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">span_id</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outputs</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">attributes</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">status</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanStatus" title="mlflow.entities.SpanStatus"><span class="pre">SpanStatus</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">'OK'</span></span></em><span class="sig-paren">)</span></dt>
<dd><p>End the span with the given trace ID and span ID.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>request_id</strong> – The ID of the trace to end.</p></li>
<li><p><strong>span_id</strong> – The ID of the span to end.</p></li>
<li><p><strong>outputs</strong> – Outputs to set on the span.</p></li>
<li><p><strong>attributes</strong> – A dictionary of attributes to set on the span. If the span already has
attributes, the new attributes will be merged with the existing ones. If the same
key already exists, the new value will overwrite the old one.</p></li>
<li><p><strong>status</strong> – The status of the span. This can be a
<a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanStatus" title="mlflow.entities.SpanStatus"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanStatus</span></code></a> object or a string
representing the status code defined in
<a class="reference internal" href="mlflow.entities.html#mlflow.entities.SpanStatusCode" title="mlflow.entities.SpanStatusCode"><code class="xref py py-class docutils literal notranslate"><span class="pre">SpanStatusCode</span></code></a>
e.g. <code class="docutils literal notranslate"><span class="pre">&quot;OK&quot;</span></code>, <code class="docutils literal notranslate"><span class="pre">&quot;ERROR&quot;</span></code>. The default status is OK.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
</div>


              </div>
            </div>
            <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mlflow.tensorflow.html" class="btn btn-neutral" title="mlflow.tensorflow" accesskey="p"><span class="db-icon db-icon-chevron-left"></span> Previous</a>
      
      
        <a href="mlflow.transformers.html" class="btn btn-neutral" title="mlflow.transformers" accesskey="n">Next <span class="db-icon db-icon-chevron-right"></span></a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
      <p class="copyright">
          &copy; MLflow Project, a Series of LF Projects, LLC. All rights reserved.
      </p>

  </div> 

</footer>
          </div>
        </div>
      </section>
    </main>
  </page>

  


  
  <script type="text/javascript">
    var DOCUMENTATION_OPTIONS = {
      URL_ROOT:'../',
      VERSION:'2.12.2',
      COLLAPSE_INDEX:false,
      FILE_SUFFIX:'.html',
      LINK_SUFFIX: '.html',
      HAS_SOURCE:  true
    };
  </script>

  

  <script type="text/javascript" src="../_static/js/clipboard.min.js"></script>
  <script type="text/javascript" src="../_static/js/jquery.waypoints.min.js"></script>

  
  
  
  <script type="text/javascript">var CLIPPY_SVG_PATH = "../_static/clippy.svg";</script>
  <script type="text/javascript" src="../_static/js/custom.js"></script>
  

  
  
  <script type="text/javascript">
    jQuery(function () {
      SphinxRtdTheme.StickyNav.enable();
    });

  </script>
  

  
  <script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        function copyToClipboard(text) {
            const textarea = document.createElement('textarea');
            textarea.value = text;
            document.body.appendChild(textarea);
            textarea.select();
            document.execCommand('copy');
            document.body.removeChild(textarea);
        }
        // Get the code block designator class entries
        const allHighlights = document.querySelectorAll('.highlight');
        // Disable copyable links for notebook cell numbering and for cell outputs
        const highlights = Array.from(allHighlights).filter(highlight => !highlight.closest('.highlight-none') && 
            !highlight.closest('.nboutput'));
    
        highlights.forEach(function(highlight) {
            const copyIcon = document.createElement('span');
            copyIcon.classList.add('copy-icon');
            copyIcon.innerHTML = '&#xf0ea;';

            copyIcon.addEventListener('click', function() {
                const code = highlight.querySelector('pre').textContent;
                copyToClipboard(code);

                // Flash effect on click
                this.style.color = '#0194E2';
                setTimeout(() => {
                    this.style.color = ''; 
                }, 100);

                // Display "Code copied to clipboard" near the clicked icon
                const message = document.createElement('span');
                message.textContent = "Copied!";
                message.classList.add('copy-message'); 

                // Append the message to the icon
                this.appendChild(message);

                setTimeout(() => {
                    this.removeChild(message);
                }, 500);
            });

            highlight.appendChild(copyIcon);
        });
    });
  </script>


<script type="text/javascript">
    document.addEventListener("DOMContentLoaded", function() {
        // Force download for notebook-download-btn
        const downloadButtons = document.querySelectorAll('.notebook-download-btn');
        downloadButtons.forEach(function(button) {
            button.addEventListener('click', function(event) {
                event.preventDefault(); // Prevent default behavior

                // Fetch the raw content of the notebook from GitHub
                fetch(button.href)
                    .then(response => response.blob())
                    .then(blob => {
                        const url = window.URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.style.display = 'none';
                        link.href = url;
                        const filename = button.href.split('/').pop();
                        link.download = filename; 

                        document.body.appendChild(link);
                        link.click();

                        window.URL.revokeObjectURL(url);
                        document.body.removeChild(link);
                    })
                    .catch(err => console.error('Error fetching the notebook:', err));
            });
        });
    });
</script> 
</body>
</html>