<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper plugin-docs plugin-id-default docs-version-current docs-doc-page docs-doc-id-llms/tracing/tracing-schema" data-has-hydrated="false">
<head>
<meta charset="UTF-8">
<meta name="generator" content="Docusaurus v3.5.2">
<title data-rh="true">MLflow Tracing Schema | MLflow</title><meta data-rh="true" name="viewport" content="width=device-width,initial-scale=1"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:image" content="https://mlflow.org/docs/latest/img/docusaurus-social-card.jpg"><meta data-rh="true" name="twitter:image" content="https://mlflow.org/docs/latest/img/docusaurus-social-card.jpg"><meta data-rh="true" property="og:url" content="https://mlflow.org/docs/latest/llms/tracing/tracing-schema"><meta data-rh="true" property="og:locale" content="en"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="MLflow Tracing Schema | MLflow"><meta data-rh="true" name="description" content="This document provides a detailed view of the schema for traces and its ingredients. MLflow traces are compatible to OpenTelemetry specs,"><meta data-rh="true" property="og:description" content="This document provides a detailed view of the schema for traces and its ingredients. MLflow traces are compatible to OpenTelemetry specs,"><link data-rh="true" rel="icon" href="/docs/latest/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://mlflow.org/docs/latest/llms/tracing/tracing-schema"><link data-rh="true" rel="alternate" href="https://mlflow.org/docs/latest/llms/tracing/tracing-schema" hreflang="en"><link data-rh="true" rel="alternate" href="https://mlflow.org/docs/latest/llms/tracing/tracing-schema" hreflang="x-default"><link rel="stylesheet" href="/docs/latest/assets/css/styles.2c4efff1.css">
<script src="/docs/latest/assets/js/runtime~main.25951f66.js" defer="defer"></script>
<script src="/docs/latest/assets/js/main.8932c774.js" defer="defer"></script>
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){try{return new URLSearchParams(window.location.search).get("docusaurus-theme")}catch(t){}}()||function(){try{return window.localStorage.getItem("theme")}catch(t){}}();t(null!==e?e:"light")}(),function(){try{const n=new URLSearchParams(window.location.search).entries();for(var[t,e]of n)if(t.startsWith("docusaurus-data-")){var a=t.replace("docusaurus-data-","data-");document.documentElement.setAttribute(a,e)}}catch(t){}}()</script><div id="__docusaurus"><div role="region" aria-label="Skip to main content"><a class="skipToContent_fXgn" href="#__docusaurus_skipToContent_fallback">Skip to main content</a></div><nav aria-label="Main" class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Toggle navigation bar" aria-expanded="false" class="navbar__toggle clean-btn" type="button"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/latest/"><div class="navbar__logo"><img src="/docs/latest/images/logo.png" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--light_NVdE"><img src="/docs/latest/images/logo.png" alt="MLflow Logo" class="themedComponent_mlkZ themedComponent--dark_xIcU"></div></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/latest/">Docs</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/facebook/docusaurus" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)" aria-live="polite"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="navbarSearchContainer_Bca1"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div id="__docusaurus_skipToContent_fallback" class="main-wrapper mainWrapper_z2l0"><div class="docsWrapper_hBAB"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docRoot_UBD9"><aside class="theme-doc-sidebar-container docSidebarContainer_YfHR"><div class="sidebarViewport_aRkj"><div class="sidebar_njMd"><nav aria-label="Docs sidebar" class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/">MLflow</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/introduction/">MLflow Overview</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/latest/getting-started/">Getting Started with MLflow</a><button aria-label="Expand sidebar category &#x27;Getting Started with MLflow&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/new-features/">New Features</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" href="/docs/latest/llms/">LLMs</a><button aria-label="Collapse sidebar category &#x27;LLMs&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--active" tabindex="0" href="/docs/latest/llms/tracing/">MLflow Tracing</a><button aria-label="Collapse sidebar category &#x27;MLflow Tracing&#x27;" aria-expanded="true" type="button" class="clean-btn menu__caret"></button></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/llms/tracing/overview">Tracing Concepts</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/latest/llms/tracing/tracing-schema">MLflow Tracing Schema</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-3 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/latest/llms/tracing/contribute">Contributing to MLflow Tracing</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/custom-pyfunc-for-llms/notebooks/custom-pyfunc-advanced-llm">custom-pyfunc-for-llms</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/dspy/notebooks/dspy_quickstart">dspy</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/langchain/notebooks/langchain-quickstart">langchain</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/llama-index/notebooks/llama_index_quickstart">llama-index</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/llm-evaluate/notebooks/huggingface-evaluation">llm-evaluate</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/notebooks/chat-model-tool-calling">notebooks</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/openai/notebooks/openai-chat-completions">openai</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/rag/notebooks/mlflow-e2e-evaluation">rag</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/sentence-transformers/tutorials/paraphrase-mining/paraphrase-mining-sentence-transformers">sentence-transformers</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" tabindex="0" href="/docs/latest/llms/transformers/tutorials/audio-transcription/whisper">transformers</a></div></li></ul></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/model-evaluation/">Model Evaluation</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/latest/deep-learning/">Deep Learning</a><button aria-label="Expand sidebar category &#x27;Deep Learning&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/latest/traditional-ml/">Traditional ML</a><button aria-label="Expand sidebar category &#x27;Traditional ML&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist" href="/docs/latest/deployment/">Deployment</a><button aria-label="Expand sidebar category &#x27;Deployment&#x27;" aria-expanded="false" type="button" class="clean-btn menu__caret"></button></div></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/tracking/">MLflow Tracking</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/system-metrics/">System Metrics</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/projects/">MLflow Projects</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/models/">MLflow Models</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/model-registry/">MLflow Model Registry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/recipes/">MLflow Recipes</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/plugins/">MLflow Plugins</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/auth/">MLflow Authentication</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/search-runs/">Search Runs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/search-experiments/">Search Experiments</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/docker/">Official MLflow Docker image</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/community-model-flavors/">Community Model Flavors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/latest/tutorials-and-examples/">Tutorials and Examples</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" role="button" aria-expanded="false" href="/docs/latest/model/notebooks/signature_examples">model</a></div></li></ul></nav></div></div></aside><main class="docMainContainer_TBSr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/docs/latest/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_YNFT"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/latest/llms/"><span itemprop="name">LLMs</span></a><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item"><a class="breadcrumbs__link" itemprop="item" href="/docs/latest/llms/tracing/"><span itemprop="name">MLflow Tracing</span></a><meta itemprop="position" content="2"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">MLflow Tracing Schema</span><meta itemprop="position" content="3"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>MLflow Tracing Schema</h1></header>
<p>This document provides a detailed view of the schema for traces and its ingredients. MLflow traces are <strong>compatible to OpenTelemetry specs</strong>,
but we also define a few additional layers of structure upon the OpenTelemetry Spans to provide additional metadata about the trace.</p>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="structure-of-traces">Structure of Traces<a href="#structure-of-traces" class="hash-link" aria-label="Direct link to Structure of Traces" title="Direct link to Structure of Traces">​</a></h2>
<p><strong>TL;DR</strong>: <code>Trace = TraceInfo + TraceData</code> where <code>TraceData = List[Span]</code></p>
<div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Trace</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Trace Info</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Trace Data</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Span</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6"><h4 class="anchor anchorWithStickyNavbar_LWe7" id="trace-structure">Trace Structure<a href="#trace-structure" class="hash-link" aria-label="Direct link to Trace Structure" title="Direct link to Trace Structure">​</a></h4><p>A <a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.Trace" target="_blank"><code>Trace</code></a> in MLflow consists of two components:
<a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.TraceInfo" target="_blank"><code>Trace Info</code></a> and
<a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.TraceData" target="_blank"><code>Trace Data</code></a>.</p><p>The metadata that aids in explaining the origination
of the trace, the status of the trace, and the information about the total execution time is stored within the Trace Info. The Trace
Data is comprised entirely of the instrumented <a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.Span" target="_blank"><code>Span</code></a>
objects that make up the core of the trace.</p><div class="max-height-img-container" style="max-height:400px"><p><img decoding="async" loading="lazy" alt="Trace Architecture" src="/docs/latest/assets/images/trace_architecture-4d7b474a12b802862207e96a40040e12.png" width="1204" height="903" class="img_ev3q"></p></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><h4 class="anchor anchorWithStickyNavbar_LWe7" id="trace-info-structure">Trace Info Structure<a href="#trace-info-structure" class="hash-link" aria-label="Direct link to Trace Info Structure" title="Direct link to Trace Info Structure">​</a></h4><p>The Trace Info within MLflow&#x27;s tracing feature aims to provide a lightweight snapshot of critical data about the overall trace.
This includes the logistical information about the trace, such as the experiment_id, providing the storage location for the trace,
as well as trace-level data such as start time and total execution time. The Trace Info also includes tags and status information for
the trace as a whole.</p><div class="max-height-img-container" style="max-height:400px"><p><img decoding="async" loading="lazy" alt="Trace Info Architecture" src="/docs/latest/assets/images/trace_info_architecture-0a66e4960efd9299f04427c0aef04a45.png" width="1242" height="994" class="img_ev3q"></p></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><h4 class="anchor anchorWithStickyNavbar_LWe7" id="trace-data-structure">Trace Data Structure<a href="#trace-data-structure" class="hash-link" aria-label="Direct link to Trace Data Structure" title="Direct link to Trace Data Structure">​</a></h4><p>The Trace Data within MLflow&#x27;s tracing feature provides the core of the trace information. Within this object is a list of
<a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.Span" target="_blank"><code>Span</code></a> objects that represent the individual steps of the trace.
These spans are associated with one another in a hierarchical relationship, providing a clear order-of-operations linkage of what
happened within your application during the trace.</p><div class="max-height-img-container" style="max-height:400px"><p><img decoding="async" loading="lazy" alt="Trace Data Architecture" src="/docs/latest/assets/images/trace_data_architecture-96cd4fb71c42d2616dd28acdba33b5e6.png" width="1243" height="935" class="img_ev3q"></p></div></div><div role="tabpanel" class="tabItem_Ymn6" hidden=""><h4 class="anchor anchorWithStickyNavbar_LWe7" id="span-structure">Span Structure<a href="#span-structure" class="hash-link" aria-label="Direct link to Span Structure" title="Direct link to Span Structure">​</a></h4><p>The Span object within MLflow&#x27;s tracing feature provides detailed information about the individual steps of the trace.
It complies to the <a href="https://opentelemetry.io/docs/concepts/signals/traces/#spans" target="_blank" rel="noopener noreferrer">OpenTelemetry Span spec</a>.
Each Span object contains information about the step being instrumented, including the span_id, name, start_time, parent_id, status,
inputs, outputs, attributes, and events.</p><div class="max-height-img-container" style="max-height:400px"><p><img decoding="async" loading="lazy" alt="Span Architecture" src="/docs/latest/assets/images/span_architecture-01e1f5a3edf522f567e7eaad16f2b1d1.png" width="1880" height="1149" class="img_ev3q"></p></div></div></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="trace">Trace<a href="#trace" class="hash-link" aria-label="Direct link to Trace" title="Direct link to Trace">​</a></h2>
<p>A trace is a root object composed of two components:</p>
<ul>
<li>
<a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.TraceInfo" target="_blank"><code>TraceInfo</code></a>
</li>
<li>
<a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.TraceData" target="_blank"><code>TraceData</code></a>
</li>
</ul>
<div class="theme-admonition theme-admonition-tip admonition_xJq3 alert alert--success"><div class="admonitionHeading_Gvgb"><span class="admonitionIcon_Rf37"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_BuS1"><p>Check the API documentation for helper methods on these dataclass objects for more information on how to convert or extract data from them.</p></div></div>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="trace-info">Trace Info<a href="#trace-info" class="hash-link" aria-label="Direct link to Trace Info" title="Direct link to Trace Info">​</a></h2>
<p>Trace Info is a dataclass object that contains metadata about the trace. This metadata includes information about the trace&#x27;s origin, status, and
various other data that aids in retrieving and filtering traces when used with <a href="/docs/latest/api_reference/python_api/mlflow.client.html#mlflow.client.MlflowClient.search_traces" target="_blank"><code>mlflow.client.MlflowClient.search_traces<!-- -->()</code></a> and for
navigation of traces within the MLflow UI.</p>
<p>To learn more about how <code>TraceInfo</code> metadata is used for searching, you can see examples <a href="/docs/latest/llms/tracing/#searching-and-retrieving-traces">here</a>.</p>
<p>The data that is contained in the <code>TraceInfo</code> object is used to populate the trace view page within the MLflow tracking UI, as shown below.</p>
<p><img decoding="async" loading="lazy" alt="TraceInfo as it is used in the MLflow UI" src="/docs/latest/assets/images/trace_info_in_ui-ad801e1eeea03ac3004bed18a34fbf8c.png" width="2920" height="918" class="img_ev3q"></p>
<p>The primary components of MLflow <a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.TraceInfo" target="_blank"><code>TraceInfo</code></a> objects are listed below.</p>
<table><thead><tr><th><strong>Property</strong></th><th><strong>Description</strong></th><th><strong>Note</strong></th></tr></thead><tbody><tr><td><strong>request_id</strong></td><td><p>A unique identifier for the trace. The identifier is used within MLflow
and integrated system to resolve the event being captured and to provide
associations for external systems to map the logged trace to the
originating caller.</p></td><td>This value is generated by the tracing backend and is immutable. Within the tracing client APIs, you will need to deliberately pass this value to the <a href="/docs/latest/api_reference/python_api/mlflow.client.html#mlflow.client.MlflowClient.start_span" target="_blank">span creation API</a> to ensure that a given span is associated with a trace.</td></tr><tr><td><strong>experiment_id</strong></td><td><p>The ID of the experiment in which the trace was logged. All logged
traces are associated with the current active experiment when the trace
is generated (during invocation of an instrumented object).</p></td><td>This value is immutable and is set by the tracing backend. It is a system-controlled value that is very useful when using the <a href="/docs/latest/api_reference/python_api/mlflow.client.html#mlflow.client.MlflowClient.search_traces" target="_blank">Search Traces</a> API.</td></tr><tr><td><strong>timestamp_ms</strong></td><td><p>The time that marks the moment when the root span of the trace was
created. This is a Unix timestamp in milliseconds.</p></td><td><p>The time reflected in this property is the time at with the trace was
created, not the time at which a request to your application was made.
As such, it does not factor into account the time it took to process the
request to the environment in which your application is being served,
which may introduce additional latency to the total round trip time,
depending on network configurations.</p></td></tr><tr><td><strong>execution_time_ms</strong></td><td><p>The time that marks the moment when the call to end the trace is made.
This is a Unix timestamp in milliseconds.</p></td><td><p>This time does not include the networking time associated with sending
the response from the environment that generates the trace to the
environment that is consuming the application’s invocation result.</p></td></tr><tr><td><strong>status</strong></td><td>An enumerated value that denotes the status of the trace.</td><td><p><code>TraceStatus</code> values are one of:</p><ul>
<li><strong>OK</strong> - The trace and the
instrumented call were successful.</li>
<li><strong>ERROR</strong> - An error occurred
while an application was being instrumented. The error can be seen
within the span data for the trace.</li>
<li><strong>IN_PROGRESS</strong> - The trace has
started and is currently running. Temporary state that will update while
spans are being logged to a trace.</li>
<li><strong>TRACE_STATUS_UNSPECIFIED</strong> -
internal default state that should not be seen in logged traces.</li>
</ul></td></tr><tr><td><strong>request_metadata</strong></td><td><p>The request metadata are additional key-value pairs of information that
are associated with the Trace, set and modified by the tracing backend.</p></td><td><p>These are not open for addition or modification by the user, but can
provide additional context about the trace, such as an MLflow <code>run_id</code>
that is associated with the trace.</p></td></tr><tr><td><strong>tags</strong></td><td><p>User-defined key-value pairs that can be applied to a trace for applying
additional context, aid in <a href="/docs/latest/llms/tracing/#searching-and-retrieving-traces">search
functionality</a>, or to
provide additional information during the creation or after the
successful logging of a trace.</p></td><td><p>These tags are fully mutable and can be changed at any time, even long
after a trace has been logged to an experiment.</p></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="trace-data">Trace Data<a href="#trace-data" class="hash-link" aria-label="Direct link to Trace Data" title="Direct link to Trace Data">​</a></h2>
<p>The MLflow <a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.trace_data.TraceData" target="_blank"><code>TraceData</code></a> object is a dataclass object that holds the core of the trace data.
This object contains the following elements:</p>
<table><thead><tr><th><strong>Property</strong></th><th><strong>Description</strong></th><th><strong>Note</strong></th></tr></thead><tbody><tr><td><strong>request</strong></td><td><p>The <code>request</code> property is the input data for the entire trace. The input
<code>str</code> is a JSON-serialized string that contains the input data for the
trace, typically the end-user request that was submitted as a call to
the application.</p></td><td><p>Due to the varied structures of inputs that could go to a given
application that is being instrumented by MLflow Tracing, all inputs are
JSON serialized for compatibility’s sake. This allows for the input data
to be stored in a consistent format, regardless of the input data’s
structure.</p></td></tr><tr><td><strong>spans</strong></td><td>This property is a list of <a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.Span" target="_blank">Span</a> objects that represent the individual steps of the trace.</td><td><p>For further information on the structure of Span objects, see the
section below.</p></td></tr><tr><td><strong>response</strong></td><td><p>The response property is the final output data that will be returned to
the caller of the invocation of the application.</p></td><td><p>Similar to the request property, this value is a JSON-serialized string
to maximize compatibility of disparate formats.</p></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="span-schema">Span Schema<a href="#span-schema" class="hash-link" aria-label="Direct link to Span Schema" title="Direct link to Span Schema">​</a></h2>
<p>Spans are the core of the trace data. They record key, critical data about each of the steps within your genai application.</p>
<p>When you view your traces within the MLflow UI, you&#x27;re looking at a collection of spans, as shown below.</p>
<p><img decoding="async" loading="lazy" alt="Spans within the MLflow UI" src="/docs/latest/assets/images/spans_in_mlflow_ui-fb6052e2093862fc0477999a92b76f7a.png" width="2684" height="2068" class="img_ev3q"></p>
<p>The sections below provide a detailed view of the structure of a span.</p>
<table><thead><tr><th><strong>Property</strong></th><th><strong>Description</strong></th><th><strong>Note</strong></th></tr></thead><tbody><tr><td><strong>inputs</strong></td><td><p>The inputs are stored as JSON-serialized strings, representing the
input data that is passed into the particular stage (step) of your
application. Due to the wide variety of input data that can be passed
between specific stages of a GenAI application, this data may be
extremely large (such as when using the output of a vector store
retrieval step).</p></td><td><p>Reviewing the Inputs, along with the Outputs, of individual stages can
dramatically increase the ability to diagnose and debug issues that
exist with responses coming from your application.</p></td></tr><tr><td><strong>outputs</strong></td><td><p>The outputs are stored as JSON-serialized strings, representing the
output data that is passed out of the particular stage (step) of your
application.</p></td><td><p>Just as with the Inputs, the Outputs can be quite large, depending on
the complexity of the data that is being passed between stages.</p></td></tr><tr><td><strong>attributes</strong></td><td><p>Attributes are metadata that are associated with a given step within
your application. These attributes are key-value pairs that can be used
to provide insight into behavioral modifications for function and method
calls, giving insight into how modification of them can affect the
performance of your application.</p></td><td><p>Common examples of attributes that could be associated with a given
span include:</p><ul>
<li><strong>model</strong></li>
<li><strong>temperature</strong></li>
<li><strong>document_count</strong></li>
</ul><p>These attributes provide additional context and insight into the results that are present in the outputs property for the span.</p></td></tr><tr><td><strong>events</strong></td><td><p>Events are a system-level property that is optionally applied to a span
only if there was an issue during the execution of the span. These
events contain information about exceptions that were thrown in the
instrumented call, as well as the stack trace.</p></td><td>This data is structured within a <a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.SpanEvent" target="_blank">SpanEvent</a> object, containing the properties:<ul>
<li><strong>name</strong></li>
<li><strong>timestamp</strong></li>
<li><strong>attributes</strong></li>
</ul><p><strong>The attributes</strong> property contains the stack trace of the exception that was thrown during the execution of the span if such an error occurred during execution.</p></td></tr><tr><td><strong>parent_id</strong></td><td><p>The <code>parent_id</code> property is an identifier that establishes the
hierarchical association of a given span with its parent span. This is
used to establish an event chain for the spans, helping to determine
which step followed another step in the execution of the application.</p></td><td><p>A span <strong>must</strong> have a <code>parent_id</code> set.</p></td></tr><tr><td><strong>span_id</strong></td><td><p>The <code>span_id</code> is a unique identifier that is generated for each span
within a trace. This identifier is used to disambiguate spans from one
another and allow for proper association of the span within the
sequential execution of other spans within a trace.</p></td><td>A <code>span_id</code> is set when a span is created and is immutable.</td></tr><tr><td><strong>request_id</strong></td><td><p>The <code>request_id</code> property is a unique identifier that is generated for
each <strong>trace</strong> and is propogated to each span that is a member of that trace.</p></td><td>The <code>request_id</code> is a system-generated propoerty and is immutable.</td></tr><tr><td><strong>name</strong></td><td><p>The name of the trace is either user-defined (optionally when using the
fluent and client APIs) or is automatically generated through CallBack
integrations or when omitting the name argument when calling the fluent
or client APIs. If the name is not overridden, the name will be
generated based on the name of the function or method that is being
instrumented.</p></td><td><p>It is recommended to provide a name for your span that is unique and
relevant to the functionality that is being executed when using manual
instumentation via the client or fluent APIs. Generic names for spans or
confusing names can make it difficult to diagnose issues when reviewing
traces.</p></td></tr><tr><td><strong>status</strong></td><td><p>The status of a span is reflected in a value from the enumeration object
<code>SpanStatusCode</code>. The span status object contains an optional description
if the <code>status_code</code> is reflecting an error that occured. The values that
the status may have are:</p><ul>
<li><strong>OK</strong> - The span and the underlying instrumented
call were successful.</li>
<li><strong>UNSET</strong> - The status of the span hasn’t been set yet
(this is the default value and should not be seen in logged trace
events)</li>
<li><strong>ERROR</strong> - An issue happened within the call being instrumented.
The <code>description</code> property will contain additional information about the
error that occurred.</li>
</ul></td><td><p>Evaluating the status of spans can greatly reduce the amount of time and
effort required to diagnose issues with your applications.</p></td></tr><tr><td><strong>start_time_ns</strong></td><td>The unix timestamp (in nanoseconds) when the span was started.</td><td><p>The precision of this property is higher than that of the trace start
time, allowing for more granular analysis of the execution time of very
short-lived spans.</p></td></tr><tr><td><strong>end_time_ns</strong></td><td>The unix timestamp (in nanoseconds) when the span was ended.</td><td><p>This precision is higher than the trace timestamps, similar to the
<code>start_time_ns</code> timestamp above.</p></td></tr></tbody></table>
<h2 class="anchor anchorWithStickyNavbar_LWe7" id="schema-for-specific-span-types">Schema for specific span types<a href="#schema-for-specific-span-types" class="hash-link" aria-label="Direct link to Schema for specific span types" title="Direct link to Schema for specific span types">​</a></h2>
<p>MLflow has a set of 10 predefined types of spans (see <a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.SpanType" target="_blank">mlflow.entities.SpanType</a>), and
certain span types have properties that are required in order to enable additional functionality
within the UI and downstream tasks such as evaluation.</p>
<h3 class="anchor anchorWithStickyNavbar_LWe7" id="retriever-spans">Retriever Spans<a href="#retriever-spans" class="hash-link" aria-label="Direct link to Retriever Spans" title="Direct link to Retriever Spans">​</a></h3>
<p>The <code>RETRIEVER</code> span type is used for operations involving retrieving data from a data store (for example, querying
documents from a vector store). The <code>RETRIEVER</code> span type has the following schema:</p>
<table><thead><tr><th><strong>Property</strong></th><th><strong>Description</strong></th><th><strong>Note</strong></th></tr></thead><tbody><tr><td><strong>Input</strong></td><td>There are no restrictions on the span inputs</td><td></td></tr><tr><td><strong>Output</strong></td><td>The output must be of type <code>List[<a href="/docs/latest/api_reference/python_api/mlflow.entities.html#mlflow.entities.Document" target="_blank">mlflow.entities.Document</a>]</code>, or a dict matching the structure of the dataclass*. The dataclass contains the following properties:<ul>
<li><strong>id</strong> (<code>Optional[str]</code>) - An optional unique identifier for the document.</li>
<li><strong>page_content</strong> (<code>str</code>) - The text content of the document.</li>
<li><strong>metadata</strong> (<code>Optional[Dict[str,any]]</code>) - The metadata associated with the document. There are two important metadata keys that are reserved for the MLflow UI and evaluation metrics:<!-- -->
<ul>
<li><code>&quot;doc_uri&quot; (str)</code>: The URI for the document. This is used for rendering a link in the UI.</li>
<li><code>&quot;chunk_id&quot; (str)</code>: If your document is broken up into chunks in your data store, this key can be used to
identify the chunk that the document is a part of. This is used by some evaluation metrics.</li>
</ul>
</li>
</ul></td><td><p>This output structure is guaranteed to be provided if the traces are generated via MLflow autologging for the LangChain and LlamaIndex flavors.
By conforming to this specification, <code>RETRIEVER</code> spans will be rendered in a more user-friendly manner in the MLflow UI, and downstream tasks
such as evaluation will function as expected.</p></td></tr><tr><td><strong>Attributes</strong></td><td>There are no restrictions on the span attributes</td><td></td></tr></tbody></table>
<p>* For example, both <code>[Document(page_content=&quot;Hello world&quot;, metadata={&quot;doc_uri&quot;: &quot;https://example.com&quot;})]</code> and
<code>[{&quot;page_content&quot;: &quot;Hello world&quot;, &quot;metadata&quot;: {&quot;doc_uri&quot;: &quot;https://example.com&quot;}}]</code> are valid outputs for a <code>RETRIEVER</code> span.</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/latest/llms/tracing/overview"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Tracing Concepts</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/latest/llms/tracing/contribute"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Contributing to MLflow Tracing</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#structure-of-traces" class="table-of-contents__link toc-highlight">Structure of Traces</a></li><li><a href="#trace" class="table-of-contents__link toc-highlight">Trace</a></li><li><a href="#trace-info" class="table-of-contents__link toc-highlight">Trace Info</a></li><li><a href="#trace-data" class="table-of-contents__link toc-highlight">Trace Data</a></li><li><a href="#span-schema" class="table-of-contents__link toc-highlight">Span Schema</a></li><li><a href="#schema-for-specific-span-types" class="table-of-contents__link toc-highlight">Schema for specific span types</a><ul><li><a href="#retriever-spans" class="table-of-contents__link toc-highlight">Retriever Spans</a></li></ul></li></ul></div></div></div></div></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://stackoverflow.com/questions/tagged/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Stack Overflow<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://discordapp.com/invite/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/docusaurus" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2024 My Project, Inc. Built with Docusaurus.</div></div></div></footer></div>
</body>
</html>